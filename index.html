<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Debt Tracker (Local)</title>
  <style>
    body{font-family:system-ui,Arial;margin:24px;max-width:800px}
    form, .card{border:1px solid #ddd;border-radius:12px;padding:16px;margin:12px 0}
    label{display:block;margin:8px 0 4px}
    input{width:100%;padding:8px}
    button{padding:10px 14px;border:1px solid #333;border-radius:8px;background:#111;color:#fff;cursor:pointer}
    table{width:100%;border-collapse:collapse;margin-top:8px}
    th,td{border-bottom:1px solid #eee;padding:8px;text-align:left;font-size:14px}
  </style>
</head>
<body>
  <h1>Debt Tracker</h1>

  <!-- simple per-device "profile" -->
  <div class="card">
    <label>Profile ID (anything: email/nickname)</label>
    <input id="profile" placeholder="e.g. sam@example.com" />
    <button id="setProfile">Use Profile</button>
    <small>Data is saved locally under this profile on this device only.</small>
  </div>

  <form id="debt-form" class="card" autocomplete="off">
    <label>Debt Name</label><input id="name" required />
    <label>Amount</label><input id="amount" type="number" step="0.01" />
    <label>APR (%)</label><input id="apr" type="number" step="0.01" />
    <label>Current Balance</label><input id="balance" type="number" step="0.01" />
    <label>Minimum Payment</label><input id="minPayment" type="number" step="0.01" />
    <label>Due Date</label><input id="dueDate" type="date" />
    <button type="submit">Add Debt</button>
  </form>

  <div class="card">
    <h3>My Debts</h3>
    <table id="list"><thead>
      <tr><th>Name</th><th>APR</th><th>Balance</th><th>Min</th><th>Due</th><th></th></tr>
    </thead><tbody></tbody></table>
  </div>

  <script>
    const $ = (id)=>document.getElementById(id);
    const tblBody = document.querySelector('#list tbody');

    let profile = localStorage.getItem('dt.profile') || '';
    $('profile').value = profile;

    function key(){ return `dt.data.${profile}`; }
    function load(){ return JSON.parse(localStorage.getItem(key())||'[]'); }
    function save(rows){ localStorage.setItem(key(), JSON.stringify(rows)); render(); }

    function render(){
      tblBody.innerHTML = '';
      if(!profile){ tblBody.innerHTML = '<tr><td colspan="6">Set a Profile ID first.</td></tr>'; return; }
      const rows = load();
      for(const [i,d] of rows.entries()){
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${d.name||''}</td>
          <td>${(+d.apr||0).toFixed(2)}%</td>
          <td>$${(+d.balance||0).toFixed(2)}</td>
          <td>$${(+d.minPayment||0).toFixed(2)}</td>
          <td>${d.dueDate||''}</td>
          <td><button data-i="${i}" class="del">âœ•</button></td>`;
        tblBody.appendChild(tr);
      }
    }

    $('setProfile').onclick = () => {
      profile = $('profile').value.trim();
      localStorage.setItem('dt.profile', profile);
      render();
    };

    document.addEventListener('click', (e)=>{
      if(e.target.classList.contains('del')){
        const i = +e.target.dataset.i;
        const rows = load(); rows.splice(i,1); save(rows);
      }
    });

    $('debt-form').onsubmit = (e)=>{
      e.preventDefault();
      if(!profile){ alert('Set a Profile ID first.'); return; }
      const d = {
        name: $('name').value.trim(),
        amount: +$('amount').value || 0,
        apr: +$('apr').value || 0,
        balance: +$('balance').value || 0,
        minPayment: +$('minPayment').value || 0,
        dueDate: $('dueDate').value || ''
      };
      const rows = load(); rows.push(d); save(rows);
      e.target.reset();
    };

    render();
  </script>
</body>
</html>
